{
  "schemaVersion": 2,
  "services": [
    {
      "name": "frontend",
      "image": "ghcr.io/seanmorley15/adventurelog-frontend:v0.11.0",
      "isMain": true,
      "internalPort": 3000,
      "environment": [
        {
          "key": "PUBLIC_SERVER_URL",
          "value": "http://backend:8000"
        },
        {
          "key": "BODY_SIZE_LIMIT",
          "value": "100000"
        }
      ],
      "dependsOn": [
        "backend"
      ]
    },
    {
      "name": "db",
      "image": "postgis/postgis:16-3.5",
      "environment": [
        {
          "key": "PGHOST",
          "value": "db"
        },
        {
          "key": "POSTGRES_DB",
          "value": "adventurelog"
        },
        {
          "key": "POSTGRES_USER",
          "value": "adventure"
        },
        {
          "key": "POSTGRES_PASSWORD",
          "value": "${DB_PASSWORD:-adventure123}"
        }
      ],
      "volumes": [
        {
          "hostPath": "${APP_DATA_DIR}/data/postgres",
          "containerPath": "/var/lib/postgresql/data",
          "readOnly": false,
          "shared": false,
          "private": false
        }
      ]
    },
    {
      "name": "backend",
      "image": "ghcr.io/seanmorley15/adventurelog-backend:v0.11.0",
      "internalPort": 80,
      "environment": [
        {
          "key": "SECRET_KEY",
          "value": "${SECRET_KEY:-adventure9secretkey}"
        },
        {
          "key": "DJANGO_ADMIN_USERNAME",
          "value": "admin"
        },
        {
          "key": "DJANGO_ADMIN_PASSWORD",
          "value": "${ADMIN_PASSWORD:-admin123}"
        },
        {
          "key": "DJANGO_ADMIN_EMAIL",
          "value": "admin@example.com"
        },
        {
          "key": "PUBLIC_URL",
          "value": "https://${APP_DOMAIN:-localhost}"
        },
        {
          "key": "CSRF_TRUSTED_ORIGINS",
          "value": "https://${APP_DOMAIN:-localhost}"
        },
        {
          "key": "DEBUG",
          "value": "False"
        },
        {
          "key": "FRONTEND_URL",
          "value": "https://${APP_DOMAIN:-localhost}"
        },
        {
          "key": "BACKEND_PORT",
          "value": "8016"
        },
        {
          "key": "PGHOST",
          "value": "db"
        },
        {
          "key": "POSTGRES_DB",
          "value": "adventurelog"
        },
        {
          "key": "POSTGRES_USER",
          "value": "adventure"
        },
        {
          "key": "POSTGRES_PASSWORD",
          "value": "${DB_PASSWORD:-adventure123}"
        }
      ],
      "volumes": [
        {
          "hostPath": "${APP_DATA_DIR}/adventurelog_media",
          "containerPath": "/code/media/",
          "readOnly": false,
          "shared": false,
          "private": false
        }
      ],
      "dependsOn": [
        "db"
      ]
    }
  ]
}